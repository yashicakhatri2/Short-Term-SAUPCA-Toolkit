function Eo = Initial_Ecalc(m, P, p)
% Compute propagated means using STTs.
% =======================================================================
% INPUTS = 
% p: Moment order
% P: Covariance
% m: Mean
%
% OUTPUT =
% Eo: Final moment of chosen order
% =======================================================================

if p == 1
    Eo = m;
elseif p == 2
    Eo = m(1) * m(2) + P;
elseif p == 3
    Eo = m(1) * m(2) * m(3) + (m(1) * P(1) + m(2) * P(2) + m(3) * P(3));
elseif p == 4
    Eo = m(1) * m(2) * m(3) * m(4) + (m(1) * m(2) * P(1) + m(1) * m(3) * ...
        P(2) + m(2) * m(3) * P(3) + m(1) * m(4) * P(4) + m(2) * m(4) * ...
        P(5) + m(3) * m(4) * P(6)) + P(6) * P(1) + P(5) * P(2) + P(3) * P(4);
elseif p == 5
    Eo = m(1) * m(2) * m(3) * m(4) * m(5) + (m(1) * m(2) * m(3) * P(1) + m(1) * m(2) * m(4) * P(2) + ...
        m(1) * m(2) * m(5) * P(3) + m(1) * m(3) * m(4) * P(4) + m(1) * m(3) * m(5) * P(5) + ...
        m(1) * m(4) * m(5) * P(6) + m(2) * m(3) * m(4) * P(7) + m(2) * m(3) * m(5) * P(8) + ...
        m(2) * m(4) * m(5) * P(9) + m(3) * m(4) * m(5) * P(10)) + (m(1) * (P(6) * P(1) + P(5) * P(2)) + ...
        m(2) * (P(9) * P(1) + P(8) * P(2)) + m(3) * (P(10) * P(1) + P(8) * P(4)) + m(4) * (P(10) * P(2) + P(9) * P(4)) + ...
        m(5) * (P(10) * P(3) + P(9) * P(5)));
elseif p == 6
    Eo = m(1) * m(2) * m(3) * m(4) * m(5) * m(6) + (m(1) * (m(2) * (m(3) * (m(4) * P(1) + m(5) * P(2) + m(6) * P(3)) + ...
        m(4) * (m(5) * P(4) + m(6) * P(5)) + m(5) * m(6) * P(6)) + m(3) * (m(4) * (m(5) * P(7) + m(6) * P(8)) + m(5) * m(6) * P(9)) + ...
        m(4) * (m(5) * m(6) * P(10))) + m(2) * (m(3) * (m(4) * (m(5) * P(11) + m(6) * P(12)) + m(5) * m(6) * P(13)) + ...
        m(4) * (m(5) * m(6) * P(14))) + m(3) * m(4) * m(5) * m(6) * P(15)) + (m(1) * (m(2) * (P(6) * P(1) + P(5) * P(2) + P(4) * P(3)) + ...
        m(3) * (P(9) * P(1) + P(8) * P(2) + P(7) * P(3)) + m(4) * (P(10) * P(1) + P(8) * P(4) + P(7) * P(5)) + m(5)* (P(10) * P(2) + P(9) * P(4) + P(7) * P(6)) + ...
        m(6) * (P(10) * P(3) + P(9) * P(5) + P(8) * P(6))) + m(2) * (m(3) * (P(13) * P(1) + P(12) * P(2) + P(11) * P(3)) + ...
        m(4) * (P(14) * P(1) + P(12) * P(4) + P(11) * P(5)) + m(5) * (P(14) * P(2) + P(13) * P(4) + P(11) * P(6)) + ...
        m(6) * (P(14) * P(3) + P(13) + P(5) + P(12) * P(6))) + m(3) * (m(4) * (P(15) * P(1) + P(12) * P(7) + P(11) * P(8)) + ...
        m(5) * (P(15) * P(2) + P(13) * P(7) + P(11) * P(9)) + m(6) * (P(15) * P(3) + P(13) * P(8) + P(12) * P(9))) + ...
        m(4) * (m(5) * (P(15) * P(4) + P(14) * P(7) + P(11) * P(10)) + m(6) * (P(15) * P(5) + P(14) * P(8) + P(12) * P(10))) + ...
        m(5) * m(6) * (P(15) * P(6) + P(14) * P(9) + P(13) * P(10))) + (P(15) * (P(6) * P(1) + P(5) * P(2) + P(4) * P(3)) + ...
        P(14) * (P(9) * P(1) + P(8) * P(2) + P(7) * P(3)) + P(13) * (P(10) * P(1) + P(8) * P(4) + P(7) * P(5)) + ...
        P(12) * (P(10) * P(2) + P(9) * P(4) + P(7) * P(6)) + P(11) * (P(10) * P(3) + P(9) * P(5) + P(8) * P(6)));
else
    Eo = inf;
    fprintf("Invalid STT order.\n")
end



end